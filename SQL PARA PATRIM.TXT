----Chamado STAFSIS-144102
call bethadba.pg_habilitartriggers('off'); commit;

----Apaga Histórico de movimentação (só tem tipo 11, depreciação)
delete from bethadba.hist_bens_contas
where i_bem in (1995,1986,2700,2120,2760,2121,2761,2122,2752,2762,2603,2123,2823,2753,2763,2683,2124,2754,2764,
2125,2765,2706,2126,2707,2117,2118,2119,2699,3000,3661,3062,3655,3656,3657,3567,3577,3658,3568,4340,4350,4341,
4351,4342,4352,4343,4344,4345,4336,4346,4337,4347,4338,4348,4339,4349,5840,5841,5842,5843,5824,5845,5836,5846,5837)
and data_mov >= 20110531
and tipo <> 1;

----Apaga transferências (Caso exista. Nesses itens não tem)
delete from bethadba.localizacoes
where i_bem in (1995,1986,2700,2120,2760,2121,2761,2122,2752,2762,2603,2123,2823,2753,2763,2683,2124,2754,2764,
2125,2765,2706,2126,2707,2117,2118,2119,2699,3000,3661,3062,3655,3656,3657,3567,3577,3658,3568,4340,4350,4341,
4351,4342,4352,4343,4344,4345,4336,4346,4337,4347,4338,4348,4339,4349,5840,5841,5842,5843,5824,5845,5836,5846,5837)
and data_transf >= 20110531;

----Apaga Reavaliações (Caso exista. Nesses itens não tem)
delete from bethadba.reav_bens
where i_bem in (1995,1986,2700,2120,2760,2121,2761,2122,2752,2762,2603,2123,2823,2753,2763,2683,2124,2754,2764,
2125,2765,2706,2126,2707,2117,2118,2119,2699,3000,3661,3062,3655,3656,3657,3567,3577,3658,3568,4340,4350,4341,
4351,4342,4352,4343,4344,4345,4336,4346,4337,4347,4338,4348,4339,4349,5840,5841,5842,5843,5824,5845,5836,5846,5837)
and data_reav_bem >= 20110531;

----Apaga Depreciações
delete from bethadba.depreciacoes
where i_bem in (1995,1986,2700,2120,2760,2121,2761,2122,2752,2762,2603,2123,2823,2753,2763,2683,2124,2754,2764,
2125,2765,2706,2126,2707,2117,2118,2119,2699,3000,3661,3062,3655,3656,3657,3567,3577,3658,3568,4340,4350,4341,
4351,4342,4352,4343,4344,4345,4336,4346,4337,4347,4338,4348,4339,4349,5840,5841,5842,5843,5824,5845,5836,5846,5837)
and data_depr >= 20110531;

----Apaga Desuso (Caso exista. Nesses itens não tem)
delete from bethadba.desusos
where i_bem in (1995,1986,2700,2120,2760,2121,2761,2122,2752,2762,2603,2123,2823,2753,2763,2683,2124,2754,2764,
2125,2765,2706,2126,2707,2117,2118,2119,2699,3000,3661,3062,3655,3656,3657,3567,3577,3658,3568,4340,4350,4341,
4351,4342,4352,4343,4344,4345,4336,4346,4337,4347,4338,4348,4339,4349,5840,5841,5842,5843,5824,5845,5836,5846,5837)
and data_des >= 20110531;

----Apaga Incorporações e desincorporações (Caso exista. Nesses itens não tem)
select * from bethadba.incorporacoes
where i_bem in (1995,1986,2700,2120,2760,2121,2761,2122,2752,2762,2603,2123,2823,2753,2763,2683,2124,2754,2764,
2125,2765,2706,2126,2707,2117,2118,2119,2699,3000,3661,3062,3655,3656,3657,3567,3577,3658,3568,4340,4350,4341,
4351,4342,4352,4343,4344,4345,4336,4346,4337,4347,4338,4348,4339,4349,5840,5841,5842,5843,5824,5845,5836,5846,5837)
and data_in_des >= 20110531;

----Apaga Baixas (Caso exista. Nesses itens não tem)
delete from bethadba.baixas
where i_bem in (1995,1986,2700,2120,2760,2121,2761,2122,2752,2762,2603,2123,2823,2753,2763,2683,2124,2754,2764,
2125,2765,2706,2126,2707,2117,2118,2119,2699,3000,3661,3062,3655,3656,3657,3567,3577,3658,3568,4340,4350,4341,
4351,4342,4352,4343,4344,4345,4336,4346,4337,4347,4338,4348,4339,4349,5840,5841,5842,5843,5824,5845,5836,5846,5837)
and data_baixa >= 20110531;

----Insere baixas
insert into bethadba.baixas (
select number()+(select max(i_baixa) from bethadba.baixas),i_bem,5,if data_aquis >= 20110531 then dateadd(day,1,data_aquis) else 20110531 endif ,
'OBSOLETO',null,null,null,null,null,null,null,null,null,null,1,null,null,null
from bethadba.bens
where i_bem in (1995,1986,2700,2120,2760,2121,2761,2122,2752,2762,2603,2123,2823,2753,2763,2683,2124,2754,2764,
2125,2765,2706,2126,2707,2117,2118,2119,2699,3000,3661,3062,3655,3656,3657,3567,3577,3658,3568,4340,4350,4341,
4351,4342,4352,4343,4344,4345,4336,4346,4337,4347,4338,4348,4339,4349,5840,5841,5842,5843,5824,5845,5836,5846,5837)
);

----Altera Flag de ativo no cadastro de bens
update bethadba.bens set situacao = 'B', uso = 'N'
where i_bem in (1995,1986,2700,2120,2760,2121,2761,2122,2752,2762,2603,2123,2823,2753,2763,2683,2124,2754,2764,
2125,2765,2706,2126,2707,2117,2118,2119,2699,3000,3661,3062,3655,3656,3657,3567,3577,3658,3568,4340,4350,4341,
4351,4342,4352,4343,4344,4345,4336,4346,4337,4347,4338,4348,4339,4349,5840,5841,5842,5843,5824,5845,5836,5846,5837);

call bethadba.pg_habilitartriggers('on');
commit;
